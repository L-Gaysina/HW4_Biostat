---
title: "HW_4_Gaisina"
author: "Gaisina Liana"
date: "2024-04-03"
output: html_document
---

# Homework № **4. Использование основных статистических тестов и поправок на множественные сравнения**

> Задание 1
>
> Рассмотрите следующую статистическую гипотезу.
>
> Проводят некоторое исследование пациентов с артериальной гипертензией. Предположим, что внедрение нового препарата в среднем лучше снижает их давление по сравнению со стандартной терапией.
>
> Задайте `seed` для воспроизводимости результатов (функция `set.seed()`). Задайте размер выборки `sample_size <- 30`. Задайте значение среднего артериального давления до приема нового препарата и после.
>
> Затем:
>
> -   Сформулируйте нулевую и альтернативную гипотезы.
>
> -   Определите уровень значимости.
>
> -   Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
>
> -   Определите наблюдаемое значение статистики, а также критическое значение статистики.
>
> -   Оцените и прокомментируйте статистическую значимость.

```{r}
set.seed(140)  #  seed для воспроизводимости результатов

# Задаём размер выборки
sample_size <- 30

# Указываем средние значения и стандартные отклонения для генерации данных
mean_before <- 150  # Среднее давление до приема препарата
mean_after <- 125   # Среднее давление после приема препарата

sd_before <- 14  # Стандартное отклонение давления до
sd_after <- 8    # Стандартное отклонение давления после

# Генерация выборок давления до и после приёма препарата
pressure_before <- rnorm(sample_size, mean_before, sd_before)
pressure_after <- rnorm(sample_size, mean_after, sd_after)

# Создание и просмотр данных в датафрейме
pressure_data <- data.frame(PressureBefore = pressure_before,
                            PressureAfter = pressure_after)

# Вывод первых нескольких строк датафрейма для просмотра
head(pressure_data)
```

###  **Формулировка гипотез**

-   **Нулевая гипотеза (H0):** Новый препарат не изменяет среднее артериальное давление по сравнению со стандартной терапией, то есть среднее изменение давления равно 0.

-   **Альтернативная гипотеза (H1):** Новый препарат в среднем лучше снижает артериальное давление по сравнению со стандартной терапией, то есть среднее изменение давления меньше 0.

### **Уровень значимости**

Допустим, что уровень значимости (alpha) задан как 0.05, что является обычной практикой в медицинских исследованиях.

### **Статистический тест**

Для проверки гипотезы о средних двух связанных выборок (до и после приема препарата) подходит t-тест для зависимых выборок. Этот тест проверяет, насколько значительно различаются пары значений, что идеально подходит для оценки эффекта воздействия препарата на пациентов. Но для проведения t-теста необходимо провести проверку на нормальность распределения

H0 - распределение соответсвует нормальному

H1 - распределение отлично от нормального

```{r}

# тест Шапиро-Уилка на нормальность распределения
shapiro.test(pressure$Pressure_Before)
shapiro.test(pressure$Pressure_After)
```

Так как значение p-value больше уровня значимости 0.05, мы принимаем нулевую гипотезу. Распределение соответсвует нормальному, значит мы можем проводить t-test.

```{r}
# Среднее значение артериального давления до приема препарата
mean_pressure_before <- mean(pressure_data$PressureBefore)

# Среднее значение артериального давления после приема препарата
mean_pressure_after <- mean(pressure_data$PressureAfter)

# Выводим средние значения
mean_pressure_before
mean_pressure_after

# Проведение парного t-теста
t_test_results <- t.test(pressure_data$PressureBefore, pressure_data$PressureAfter, paired = TRUE)

# Вывод результатов t-теста
t_test_results

```

```{r}
# Задаем уровень значимости
alpha <- 0.05

# Проверяем результаты t-теста
if(t_test_results$p.value < alpha) {
  cat("Наблюдаются убедительные статистические свидетельства в пользу того, что препарат обладает лучшей эффективностью по сравнению со стандартным лечением в части снижения уровня артериального давления.\n")
} else {
  cat("Статистически значимых свидетельств, подтверждающих превосходство нового препарата перед стандартным лечением в вопросе снижения артериального давления, обнаружено не было.\n")
}
```

```{r}
alpha <- 0.05
critical_value <- qt(1 - alpha/2, df = 29)

critical_value
```

### **Интерпретация результатов**

-   Наблюдаемое значение t-статистики (8.69) значительно превышает критическое значение(2.05), что указывает на статистическую значимость различий между выборками.

-   **P-значение** гораздо меньше заданного уровня значимости (0.05), что дополнительно подтверждает статистическую значимость результатов.

-   **Доверительный интервал для разницы средних** не включает ноль, что также указывает на статистическую значимость различий между средними значениями давления до и после приема препарата.

-   **Средняя разница** между давлением до и после составляет30.75 единиц, что является значимым улучшением и свидетельствует о потенциальной эффективности препарата.

### **Вывод**

На основе проведенного анализа можно утверждать, что есть статистически значимые доказательства эффективности нового препарата в снижении артериального давления по сравнению с изначальным уровнем давления. Результаты ясно показывают, что препарат оказывает значительное влияние на снижение артериального давления у исследуемой группы пациентов, что подтверждается как наблюдаемым значением t-статистики, так и очень низким p-значением.

> Задание 2
>
> Рассмотрите следующую статистическую гипотезу.
>
> Существует некоторая связь между курением и развитием рака легких. Пусть у курящих людей вероятность заболеть раком легких составляет 0.8, а у некурящих – 0.2
>
> Рассмотрите два случая: для выборки sample_size1 \<- 100 и sample_size2 \<- 30. Сгенерируйте данные по курению с помощью функции rep(), пусть отношение числа курящих к некурящим в каждой выборке составляет 1:1.
>
> -   Сформулируйте нулевую и альтернативную гипотезы.
>
> -   Определите уровень значимости.
>
> -   Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
>
> -   Определите наблюдаемое значение статистики, а также критическое значение статистики.
>
> -   Оцените и прокомментируйте статистическую значимость. (3 балла)

```{r}

```

> Задание 3
>
> Рассмотрите следующую статистическую гипотезу. 
>
> Применение нового метода лечения синдрома раздраженного кишечника значимо меняет уровень болевых симптомов по сравнению с группой, прошедшей лечение диетотерапией. (исследователь избегает любых допущений, кроме того, что выборки независимы и имеют одинаковое распределение)
>
> -   Сформулируйте нулевую и альтернативную гипотезы.
>
> -   Определите уровень значимости.
>
> -   Выберите статистический тест для проверки гипотезы и аргументируйте свой выбор.
>
> -   Определите наблюдаемое значение статистики, а также критическое значение статистики.
>
> -   Оцените и прокомментируйте статистическую значимость. (3 балла)

> Задание 4
>
> Рассмотрите следующую гипотезу.
>
> Проводится исследование, в котором исследуются три противоопухолевые препарата A, B плацебо (0) на трех группах мышей. В каждой из трех групп по 10 мышей.  Оценивается размер опухоли у мыши.
>
> Сгенерируйте датасет следующим образом:
>
> `tumor <- tibble(`
>
> `therapy = c(rep("0", 10), rep("A", 10), rep("B", 10)),`
>
> `value = c(rep(3213, 10), rep(2687, 10), rep(2423, 10))`
>
> `) %>%`
>
> `mutate(therapy = factor(therapy, levels = c("0", "A", "B")))`
>
> `tumor$value <- tumor$value + rnorm(30, 0, 760)`
>
> Постройте на одном графике три “ящика с усами” для наглядности.
>
> -   проведите дисперсионный анализ, чтобы выяснить, есть ли разница между размером опухоли во всех группах. Прокомментируйте получившийся результат.
>
> -   с помощью функции TukeyHSD() проведите попарные сравнения, используя критерий Тьюки. Прокомментируйте полученные результаты.
